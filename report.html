<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>GetInTheCar ‚Äî Reports & Analytics</title>
<link rel="stylesheet" href="style.css">
<style>
/* Reports & Analytics Specific Styles */
.analytics-header {
  background: rgba(255, 255, 255, 0.03);
  border-bottom: 1px solid rgba(255, 85, 85, 0.1);
  padding: 24px;
  backdrop-filter: blur(10px);
}

.header-title {
  font-size: 28px;
  font-weight: 800;
  background: linear-gradient(90deg, #ff5555, #ffdd00);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  margin-bottom: 8px;
}

.date-range-selector {
  display: flex;
  align-items: center;
  gap: 12px;
  margin: 20px 20px 0;
  padding: 16px;
  background: rgba(255, 255, 255, 0.03);
  border: 1px solid rgba(255, 85, 85, 0.1);
  border-radius: 12px;
  backdrop-filter: blur(10px);
}

.date-input {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 85, 85, 0.2);
  border-radius: 8px;
  padding: 10px 16px;
  color: var(--text);
  font-size: 14px;
}

.date-input:focus {
  outline: none;
  border-color: #ff5555;
  box-shadow: 0 0 0 2px rgba(255, 85, 85, 0.2);
}

.date-presets {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}

.date-preset-btn {
  padding: 8px 16px;
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 85, 85, 0.1);
  border-radius: 8px;
  color: var(--muted);
  font-size: 13px;
  cursor: pointer;
  transition: all 0.2s;
}

.date-preset-btn:hover {
  background: rgba(255, 85, 85, 0.05);
  border-color: rgba(255, 85, 85, 0.3);
  color: var(--text);
}

.date-preset-btn.active {
  background: linear-gradient(135deg, rgba(255, 85, 85, 0.2), rgba(255, 221, 0, 0.1));
  border-color: rgba(255, 85, 85, 0.2);
  color: #ff5555;
}

/* Analytics Dashboard */
.analytics-dashboard {
  padding: 20px;
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 20px;
}

.analytics-card {
  background: rgba(255, 255, 255, 0.03);
  border: 1px solid rgba(255, 85, 85, 0.1);
  border-radius: 16px;
  padding: 24px;
  backdrop-filter: blur(10px);
}

.analytics-card-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
  padding-bottom: 12px;
  border-bottom: 1px solid rgba(255, 85, 85, 0.1);
}

.analytics-card-title {
  font-size: 18px;
  font-weight: 700;
  color: #ffdd00;
}

/* KPI Cards */
.kpi-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 16px;
  margin: 20px;
}

.kpi-card {
  background: rgba(255, 255, 255, 0.03);
  border: 1px solid rgba(255, 85, 85, 0.1);
  border-radius: 12px;
  padding: 24px;
  text-align: center;
  transition: all 0.2s;
}

.kpi-card:hover {
  background: rgba(255, 85, 85, 0.05);
  border-color: rgba(255, 85, 85, 0.2);
  transform: translateY(-2px);
}

.kpi-value {
  font-size: 36px;
  font-weight: 800;
  margin-bottom: 8px;
  background: linear-gradient(90deg, #ff5555, #ffdd00);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.kpi-label {
  font-size: 14px;
  color: var(--muted);
  margin-bottom: 4px;
}

.kpi-change {
  font-size: 12px;
  color: var(--muted);
}

.kpi-change.positive {
  color: #4CAF50;
}

.kpi-change.negative {
  color: #ff6b6b;
}

/* Chart Containers */
.chart-container {
  height: 300px;
  width: 100%;
  margin: 20px 0;
}

.mini-chart {
  height: 80px;
  width: 100%;
}

/* Revenue Chart */
.revenue-chart-container {
  position: relative;
  height: 250px;
  margin-top: 20px;
}

.revenue-bar {
  display: flex;
  align-items: flex-end;
  justify-content: space-between;
  height: 200px;
  padding: 0 20px;
  border-bottom: 1px solid rgba(255, 85, 85, 0.1);
}

.bar {
  width: 30px;
  background: linear-gradient(to top, #ff5555, #ffdd00);
  border-radius: 4px 4px 0 0;
  position: relative;
  transition: all 0.3s;
}

.bar:hover {
  transform: scale(1.05);
  box-shadow: 0 5px 15px rgba(255, 85, 85, 0.3);
}

.bar-label {
  position: absolute;
  top: -25px;
  left: 50%;
  transform: translateX(-50%);
  font-size: 12px;
  color: var(--muted);
}

.bar-value {
  position: absolute;
  bottom: -25px;
  left: 50%;
  transform: translateX(-50%);
  font-size: 12px;
  font-weight: 600;
  color: var(--text);
}

/* Metrics Grid */
.metrics-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  gap: 12px;
  margin-top: 20px;
}

.metric-item {
  background: rgba(255, 255, 255, 0.02);
  border: 1px solid rgba(255, 85, 85, 0.05);
  border-radius: 8px;
  padding: 12px;
  text-align: center;
}

.metric-value {
  font-size: 20px;
  font-weight: 800;
  margin-bottom: 4px;
  color: #ffdd00;
}

.metric-label {
  font-size: 11px;
  color: var(--muted);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

/* Leaderboards */
.leaderboard {
  max-height: 300px;
  overflow-y: auto;
  margin-top: 20px;
}

.leaderboard-item {
  display: flex;
  align-items: center;
  padding: 12px;
  background: rgba(255, 255, 255, 0.02);
  border: 1px solid rgba(255, 85, 85, 0.05);
  border-radius: 8px;
  margin-bottom: 8px;
}

.leaderboard-rank {
  width: 30px;
  height: 30px;
  background: linear-gradient(135deg, #ff5555, #ffdd00);
  color: #0a0a0f;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 800;
  font-size: 14px;
  margin-right: 12px;
}

.leaderboard-info {
  flex: 1;
}

.leaderboard-name {
  font-weight: 700;
  font-size: 14px;
  margin-bottom: 2px;
}

.leaderboard-value {
  font-size: 18px;
  font-weight: 800;
  color: #ffdd00;
  text-align: right;
}

/* Report Types */
.report-types {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 16px;
  margin: 20px;
}

.report-type-card {
  background: rgba(255, 255, 255, 0.03);
  border: 1px solid rgba(255, 85, 85, 0.1);
  border-radius: 12px;
  padding: 24px;
  text-align: center;
  cursor: pointer;
  transition: all 0.3s;
}

.report-type-card:hover {
  background: rgba(255, 85, 85, 0.05);
  border-color: rgba(255, 85, 85, 0.3);
  transform: translateY(-4px);
}

.report-icon {
  font-size: 48px;
  margin-bottom: 16px;
}

.report-title {
  font-size: 18px;
  font-weight: 700;
  margin-bottom: 8px;
  color: #ffdd00;
}

.report-description {
  font-size: 13px;
  color: var(--muted);
  margin-bottom: 16px;
  line-height: 1.5;
}

/* Export Options */
.export-options {
  display: flex;
  gap: 12px;
  margin-top: 16px;
  justify-content: center;
}

.export-btn {
  padding: 8px 16px;
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 85, 85, 0.1);
  border-radius: 8px;
  color: var(--text);
  font-size: 13px;
  cursor: pointer;
  transition: all 0.2s;
}

.export-btn:hover {
  background: rgba(255, 85, 85, 0.1);
  border-color: rgba(255, 85, 85, 0.3);
  color: #ff5555;
}

/* Timeline Chart */
.timeline-chart {
  display: flex;
  align-items: flex-end;
  height: 200px;
  padding: 0 20px;
  border-bottom: 1px solid rgba(255, 85, 85, 0.1);
}

.timeline-point {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  position: relative;
}

.point-value {
  font-size: 12px;
  font-weight: 600;
  margin-bottom: 4px;
  color: var(--text);
}

.point-dot {
  width: 8px;
  height: 8px;
  background: linear-gradient(135deg, #ff5555, #ffdd00);
  border-radius: 50%;
  position: relative;
}

.point-line {
  width: 100%;
  height: 2px;
  background: linear-gradient(90deg, rgba(255, 85, 85, 0.5), rgba(255, 221, 0, 0.5));
  position: absolute;
  top: 4px;
  left: 50%;
}

.point-label {
  position: absolute;
  bottom: -25px;
  font-size: 11px;
  color: var(--muted);
}

/* Comparison Cards */
.comparison-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 16px;
  margin-top: 20px;
}

.comparison-card {
  background: rgba(255, 255, 255, 0.02);
  border: 1px solid rgba(255, 85, 85, 0.05);
  border-radius: 8px;
  padding: 16px;
  text-align: center;
}

.comparison-value {
  font-size: 24px;
  font-weight: 800;
  margin-bottom: 4px;
}

.comparison-label {
  font-size: 11px;
  color: var(--muted);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.comparison-change {
  font-size: 12px;
  margin-top: 4px;
}

/* Report Tables */
.report-table-container {
  background: rgba(255, 255, 255, 0.03);
  border: 1px solid rgba(255, 85, 85, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin: 20px;
  backdrop-filter: blur(10px);
}

.report-table {
  width: 100%;
  border-collapse: collapse;
}

.report-table th {
  text-align: left;
  padding: 12px 16px;
  font-size: 12px;
  color: var(--muted);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  border-bottom: 1px solid rgba(255, 85, 85, 0.1);
  background: rgba(255, 255, 255, 0.02);
}

.report-table td {
  padding: 12px 16px;
  border-bottom: 1px solid rgba(255, 85, 85, 0.05);
  font-size: 14px;
}

.report-table tr:hover {
  background: rgba(255, 85, 85, 0.05);
}

/* Filter Controls */
.filter-controls {
  display: flex;
  gap: 12px;
  margin-bottom: 20px;
  flex-wrap: wrap;
}

.filter-select {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 85, 85, 0.2);
  border-radius: 8px;
  padding: 10px 16px;
  color: var(--text);
  font-size: 14px;
  min-width: 150px;
}

.filter-select:focus {
  outline: none;
  border-color: #ff5555;
  box-shadow: 0 0 0 2px rgba(255, 85, 85, 0.2);
}

/* Modal Styles */
.modal-overlay {
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: rgba(0,0,0,0.7);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
  backdrop-filter: blur(4px);
}

.report-modal {
  background: linear-gradient(135deg, rgba(255,255,255,0.05) 0%, rgba(255,255,255,0.02) 100%);
  border: 1px solid rgba(255, 85, 85, 0.15);
  border-radius: 16px;
  width: 90%;
  max-width: 800px;
  max-height: 90vh;
  overflow-y: auto;
  padding: 32px;
  color: var(--text);
  box-shadow: 0 20px 60px rgba(255, 59, 48, 0.15), 
              0 0 0 1px rgba(255, 221, 0, 0.1);
}

.modal-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 24px;
  padding-bottom: 16px;
  border-bottom: 1px solid rgba(255, 85, 85, 0.1);
}

.modal-title {
  font-size: 24px;
  font-weight: 700;
  background: linear-gradient(90deg, #ff5555, #ffdd00);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.close-btn {
  background: none;
  border: none;
  color: var(--muted);
  font-size: 28px;
  cursor: pointer;
  padding: 0;
  width: 40px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 8px;
  transition: all 0.2s;
}

.close-btn:hover {
  background: rgba(255, 85, 85, 0.1);
  color: #ff5555;
}

/* Form Styles */
.form-group {
  margin-bottom: 20px;
}

.form-row {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 16px;
  margin-bottom: 16px;
}

.form-label {
  display: block;
  margin-bottom: 8px;
  font-size: 14px;
  font-weight: 600;
  color: var(--text);
}

.form-input {
  width: 100%;
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 85, 85, 0.2);
  border-radius: 8px;
  padding: 12px 16px;
  color: var(--text);
  font-size: 14px;
  transition: all 0.2s;
}

.form-input:focus {
  outline: none;
  border-color: #ff5555;
  box-shadow: 0 0 0 2px rgba(255, 85, 85, 0.2);
}

.form-select {
  width: 100%;
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 85, 85, 0.2);
  border-radius: 8px;
  padding: 12px 16px;
  color: var(--text);
  font-size: 14px;
  transition: all 0.2s;
}

.form-select:focus {
  outline: none;
  border-color: #ff5555;
  box-shadow: 0 0 0 2px rgba(255, 85, 85, 0.2);
}

.form-checkbox {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 12px;
}

/* Modal Actions */
.modal-actions {
  display: flex;
  justify-content: flex-end;
  gap: 12px;
  margin-top: 32px;
  padding-top: 24px;
  border-top: 1px solid rgba(255, 85, 85, 0.1);
}

/* Loading State */
.loading-spinner {
  display: inline-block;
  width: 20px;
  height: 20px;
  border: 2px solid rgba(255, 85, 85, 0.1);
  border-top: 2px solid #ff5555;
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

/* Responsive Design */
@media (max-width: 768px) {
  .analytics-dashboard {
    grid-template-columns: 1fr;
    padding: 10px;
  }
  
  .kpi-grid {
    grid-template-columns: repeat(2, 1fr);
    margin: 10px;
  }
  
  .report-types {
    grid-template-columns: 1fr;
    margin: 10px;
  }
  
  .date-range-selector {
    flex-direction: column;
    align-items: stretch;
    margin: 10px;
  }
  
  .report-table-container {
    margin: 10px;
    padding: 10px;
    overflow-x: auto;
  }
  
  .report-table {
    min-width: 800px;
  }
  
  .form-row {
    grid-template-columns: 1fr;
  }
}
</style>
</head>
<body class="dark">

<!-- SIDEBAR -->
<aside class="sidebar card fade-in">
  <div class="brand">
    <div class="logo">GET</div>
    <div>
      <h2>GetInTheCar</h2>
      <div class="small muted">Admin Dashboard</div>
    </div>
  </div>

  <nav>
    <a href="admin.html">üìä Dashboard</a>
    <a href="manage-users.html">üë• User Management</a>
    <a href="manage-drivers.html">üöó Driver Management</a>
    <a href="reports.html" class="active">üìà Reports & Analytics</a>
    <a href="index.html">üîê Log Out</a>
  </nav>

  <div class="toggle-row">
    <div class="small muted">Dark Mode</div>
    <div id="darkSwitch" class="switch dark-toggle-on" title="Toggle dark mode">
      <div class="knob"></div>
    </div>
  </div>
</aside>

<!-- MAIN -->
<main class="main">
  <!-- Analytics Header -->
  <div class="analytics-header">
    <div class="header-title">Reports & Analytics</div>
    <div class="small muted">Comprehensive insights and performance metrics</div>
  </div>

  <!-- Date Range Selector -->
  <div class="date-range-selector">
    <div>
      <div class="small muted" style="margin-bottom: 8px;">Date Range</div>
      <div style="display: flex; align-items: center; gap: 12px;">
        <input type="date" class="date-input" id="startDate" value="2024-01-01">
        <span class="small muted">to</span>
        <input type="date" class="date-input" id="endDate" value="2024-12-31">
      </div>
    </div>
    
    <div>
      <div class="small muted" style="margin-bottom: 8px;">Quick Presets</div>
      <div class="date-presets">
        <button class="date-preset-btn active" onclick="setDateRange('today')">Today</button>
        <button class="date-preset-btn" onclick="setDateRange('yesterday')">Yesterday</button>
        <button class="date-preset-btn" onclick="setDateRange('week')">This Week</button>
        <button class="date-preset-btn" onclick="setDateRange('month')">This Month</button>
        <button class="date-preset-btn" onclick="setDateRange('quarter')">This Quarter</button>
        <button class="date-preset-btn" onclick="setDateRange('year')">This Year</button>
      </div>
    </div>
    
    <div>
      <button class="btn" onclick="generateReport()" style="padding: 10px 20px;">Generate Report</button>
    </div>
  </div>

  <!-- KPI Dashboard -->
  <div class="kpi-grid">
    <div class="kpi-card">
      <div class="kpi-value" id="totalRevenue">RM 45,280.50</div>
      <div class="kpi-label">Total Revenue</div>
      <div class="kpi-change positive">+12.5% from last month</div>
    </div>
    
    <div class="kpi-card">
      <div class="kpi-value" id="totalRides">1,247</div>
      <div class="kpi-label">Total Rides</div>
      <div class="kpi-change positive">+8.3% from last month</div>
    </div>
    
    <div class="kpi-card">
      <div class="kpi-value" id="avgRating">4.7</div>
      <div class="kpi-label">Average Rating</div>
      <div class="kpi-change positive">+0.2 from last month</div>
    </div>
    
    <div class="kpi-card">
      <div class="kpi-value" id="completionRate">96.2%</div>
      <div class="kpi-label">Completion Rate</div>
      <div class="kpi-change negative">-0.8% from last month</div>
    </div>
    
    <div class="kpi-card">
      <div class="kpi-value" id="newUsers">156</div>
      <div class="kpi-label">New Users</div>
      <div class="kpi-change positive">+24 from last month</div>
    </div>
    
    <div class="kpi-card">
      <div class="kpi-value" id="activeDrivers">32</div>
      <div class="kpi-label">Active Drivers</div>
      <div class="kpi-change positive">+4 from last month</div>
    </div>
  </div>

  <!-- Main Analytics Dashboard -->
  <div class="analytics-dashboard">
    <!-- Revenue Analysis -->
    <div class="analytics-card">
      <div class="analytics-card-header">
        <div class="analytics-card-title">üí∞ Revenue Analysis</div>
        <select class="filter-select" style="padding: 6px 12px; font-size: 12px;" onchange="updateRevenueChart(this.value)">
          <option value="daily">Daily</option>
          <option value="weekly" selected>Weekly</option>
          <option value="monthly">Monthly</option>
        </select>
      </div>
      
      <div class="revenue-chart-container">
        <div class="revenue-bar" id="revenueChart">
          <!-- Bars will be dynamically generated -->
        </div>
      </div>
      
      <div class="metrics-grid">
        <div class="metric-item">
          <div class="metric-value">RM 15,240</div>
          <div class="metric-label">This Month</div>
        </div>
        <div class="metric-item">
          <div class="metric-value">+12.5%</div>
          <div class="metric-label">Growth</div>
        </div>
        <div class="metric-item">
          <div class="metric-value">RM 128.40</div>
          <div class="metric-label">Avg per Ride</div>
        </div>
        <div class="metric-item">
          <div class="metric-value">RM 1,415</div>
          <div class="metric-label">Daily Avg</div>
        </div>
      </div>
    </div>

    <!-- Ride Performance -->
    <div class="analytics-card">
      <div class="analytics-card-header">
        <div class="analytics-card-title">üöó Ride Performance</div>
        <select class="filter-select" style="padding: 6px 12px; font-size: 12px;" onchange="updateRideMetrics(this.value)">
          <option value="vehicle">By Vehicle</option>
          <option value="time" selected>By Time</option>
          <option value="distance">By Distance</option>
        </select>
      </div>
      
      <div class="chart-container">
        <div class="timeline-chart" id="rideChart">
          <!-- Timeline will be dynamically generated -->
        </div>
      </div>
      
      <div class="comparison-grid">
        <div class="comparison-card">
          <div class="comparison-value" style="color: #ff5555;">847</div>
          <div class="comparison-label">Car Rides</div>
          <div class="comparison-change positive">+12%</div>
        </div>
        <div class="comparison-card">
          <div class="comparison-value" style="color: #ffdd00;">400</div>
          <div class="comparison-label">Motor Rides</div>
          <div class="comparison-change positive">+8%</div>
        </div>
      </div>
    </div>

    <!-- User Growth -->
    <div class="analytics-card">
      <div class="analytics-card-header">
        <div class="analytics-card-title">üìà User Growth</div>
        <select class="filter-select" style="padding: 6px 12px; font-size: 12px;" onchange="updateUserChart(this.value)">
          <option value="daily">Daily</option>
          <option value="weekly" selected>Weekly</option>
          <option value="monthly">Monthly</option>
        </select>
      </div>
      
      <div class="chart-container">
        <div class="revenue-bar" id="userChart" style="height: 200px;">
          <!-- Bars will be dynamically generated -->
        </div>
      </div>
      
      <div class="metrics-grid">
        <div class="metric-item">
          <div class="metric-value">156</div>
          <div class="metric-label">New Users</div>
        </div>
        <div class="metric-item">
          <div class="metric-value">+15%</div>
          <div class="metric-label">Growth Rate</div>
        </div>
        <div class="metric-item">
          <div class="metric-value">89%</div>
          <div class="metric-label">Retention</div>
        </div>
        <div class="metric-item">
          <div class="metric-value">2.4</div>
          <div class="metric-label">Avg Rides/User</div>
        </div>
      </div>
    </div>

    <!-- Driver Performance -->
    <div class="analytics-card">
      <div class="analytics-card-header">
        <div class="analytics-card-title">‚≠ê Top Drivers</div>
        <select class="filter-select" style="padding: 6px 12px; font-size: 12px;" onchange="updateDriverLeaderboard(this.value)">
          <option value="rating" selected>By Rating</option>
          <option value="rides">By Rides</option>
          <option value="earnings">By Earnings</option>
        </select>
      </div>
      
      <div class="leaderboard" id="driverLeaderboard">
        <!-- Leaderboard items will be dynamically generated -->
      </div>
    </div>

    <!-- Peak Hours -->
    <div class="analytics-card">
      <div class="analytics-card-header">
        <div class="analytics-card-title">‚è∞ Peak Hours</div>
        <select class="filter-select" style="padding: 6px 12px; font-size: 12px;" onchange="updatePeakHours(this.value)">
          <option value="weekday" selected>Weekdays</option>
          <option value="weekend">Weekends</option>
          <option value="all">All Days</option>
        </select>
      </div>
      
      <div class="chart-container">
        <div class="revenue-bar" id="peakHoursChart" style="height: 200px;">
          <!-- Bars will be dynamically generated -->
        </div>
      </div>
      
      <div style="text-align: center; margin-top: 20px;">
        <div style="font-size: 12px; color: var(--muted);">Busiest Time: <span style="color: #ff5555; font-weight: 600;">8:00 AM - 9:00 AM</span></div>
        <div style="font-size: 12px; color: var(--muted); margin-top: 4px;">Avg Rides per Hour: <span style="color: #ffdd00; font-weight: 600;">42</span></div>
      </div>
    </div>

    <!-- Popular Routes -->
    <div class="analytics-card">
      <div class="analytics-card-header">
        <div class="analytics-card-title">üìç Popular Routes</div>
        <select class="filter-select" style="padding: 6px 12px; font-size: 12px;" onchange="updatePopularRoutes(this.value)">
          <option value="daily">Today</option>
          <option value="weekly" selected>This Week</option>
          <option value="monthly">This Month</option>
        </select>
      </div>
      
      <div class="leaderboard" id="popularRoutes">
        <!-- Route items will be dynamically generated -->
      </div>
    </div>
  </div>

  <!-- Report Types Section -->
  <div style="padding: 20px;">
    <div class="analytics-card">
      <div class="analytics-card-header">
        <div class="analytics-card-title">üìä Generate Reports</div>
        <div class="small muted">Select report type to generate detailed analysis</div>
      </div>
      
      <div class="report-types">
        <div class="report-type-card" onclick="openReportModal('financial')">
          <div class="report-icon">üí∞</div>
          <div class="report-title">Financial Report</div>
          <div class="report-description">Complete revenue, expenses, and profit analysis with detailed breakdowns</div>
          <div class="export-options">
            <button class="export-btn" onclick="event.stopPropagation(); exportReport('financial', 'pdf')">PDF</button>
            <button class="export-btn" onclick="event.stopPropagation(); exportReport('financial', 'excel')">Excel</button>
            <button class="export-btn" onclick="event.stopPropagation(); exportReport('financial', 'csv')">CSV</button>
          </div>
        </div>
        
        <div class="report-type-card" onclick="openReportModal('operational')">
          <div class="report-icon">üöó</div>
          <div class="report-title">Operational Report</div>
          <div class="report-description">Ride statistics, driver performance, and operational efficiency metrics</div>
          <div class="export-options">
            <button class="export-btn" onclick="event.stopPropagation(); exportReport('operational', 'pdf')">PDF</button>
            <button class="export-btn" onclick="event.stopPropagation(); exportReport('operational', 'excel')">Excel</button>
            <button class="export-btn" onclick="event.stopPropagation(); exportReport('operational', 'csv')">CSV</button>
          </div>
        </div>
        
        <div class="report-type-card" onclick="openReportModal('user')">
          <div class="report-icon">üë•</div>
          <div class="report-title">User Analytics</div>
          <div class="report-description">User growth, retention rates, and behavioral analysis with demographics</div>
          <div class="export-options">
            <button class="export-btn" onclick="event.stopPropagation(); exportReport('user', 'pdf')">PDF</button>
            <button class="export-btn" onclick="event.stopPropagation(); exportReport('user', 'excel')">Excel</button>
            <button class="export-btn" onclick="event.stopPropagation(); exportReport('user', 'csv')">CSV</button>
          </div>
        </div>
        
        <div class="report-type-card" onclick="openReportModal('driver')">
          <div class="report-icon">‚≠ê</div>
          <div class="report-title">Driver Performance</div>
          <div class="report-description">Driver ratings, earnings, compliance, and performance benchmarking</div>
          <div class="export-options">
            <button class="export-btn" onclick="event.stopPropagation(); exportReport('driver', 'pdf')">PDF</button>
            <button class="export-btn" onclick="event.stopPropagation(); exportReport('driver', 'excel')">Excel</button>
            <button class="export-btn" onclick="event.stopPropagation(); exportReport('driver', 'csv')">CSV</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Detailed Report Tables -->
  <div class="report-table-container">
    <div class="analytics-card-header">
      <div class="analytics-card-title">üìã Detailed Reports</div>
      <select class="filter-select" style="padding: 6px 12px; font-size: 12px;" onchange="updateDetailedTable(this.value)">
        <option value="recent">Recent Rides</option>
        <option value="revenue">Revenue Breakdown</option>
        <option value="users">User Activity</option>
        <option value="drivers">Driver Performance</option>
      </select>
    </div>
    
    <table class="report-table" id="detailedTable">
      <thead>
        <tr>
          <th>Date</th>
          <th>User</th>
          <th>Driver</th>
          <th>Route</th>
          <th>Distance</th>
          <th>Fare</th>
          <th>Rating</th>
          <th>Status</th>
        </tr>
      </thead>
      <tbody id="detailedTableBody">
        <!-- Table rows will be dynamically generated -->
      </tbody>
    </table>
  </div>
</main>

<!-- Report Generation Modal -->
<div id="reportModal" class="modal-overlay" style="display:none;">
  <div class="report-modal">
    <div class="modal-header">
      <div class="modal-title" id="reportModalTitle">Generate Report</div>
      <button class="close-btn" onclick="closeReportModal()">√ó</button>
    </div>
    
    <div id="reportModalContent">
      <!-- Report configuration will be dynamically inserted -->
    </div>
  </div>
</div>

<!-- Export Loading Modal -->
<div id="exportModal" class="modal-overlay" style="display:none;">
  <div class="report-modal" style="max-width: 400px; text-align: center;">
    <div class="modal-header">
      <div class="modal-title">Exporting Report</div>
      <button class="close-btn" onclick="closeExportModal()">√ó</button>
    </div>
    
    <div style="padding: 40px 20px;">
      <div class="loading-spinner" style="width: 40px; height: 40px; margin: 0 auto 20px;"></div>
      <div id="exportMessage">Preparing your report...</div>
      <div class="small muted" style="margin-top: 8px;">This may take a few seconds</div>
    </div>
  </div>
</div>

<script>
// Theme toggle logic
const body = document.body;
const darkSwitch = document.getElementById('darkSwitch');
darkSwitch.addEventListener('click', () => {
  const knob = darkSwitch.querySelector('.knob');
  darkSwitch.classList.toggle('dark-toggle-on');
  body.classList.toggle('dark');
  if (body.classList.contains('dark')) {
    knob.style.left = '25px';
    knob.style.boxShadow = '0 10px 30px rgba(255, 221, 0, 0.12)';
  } else {
    knob.style.left = '3px';
    knob.style.boxShadow = '0 6px 18px rgba(255, 59, 48, 0.12)';
  }
});

// Sample Data
const reportsData = {
  revenue: {
    labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4', 'Week 5'],
    values: [8200, 10500, 12400, 15240, 14200],
    dailyAvg: 1415,
    growth: 12.5,
    avgPerRide: 128.40
  },
  
  rides: {
    timeline: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
    values: [142, 156, 138, 165, 148, 132, 120],
    carRides: 847,
    motorRides: 400,
    avgDistance: 7.8
  },
  
  users: {
    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
    values: [1200, 1350, 1480, 1620, 1750, 1890],
    newUsers: 156,
    growthRate: 15,
    retention: 89,
    avgRidesPerUser: 2.4
  },
  
  drivers: [
    { name: 'Yaseer Yahaya', rating: 4.9, rides: 1247, earnings: 12450 },
    { name: 'Masturina Balqis', rating: 4.8, rides: 892, earnings: 8920 },
    { name: 'Aiman Iskandar', rating: 4.7, rides: 1563, earnings: 15630 },
    { name: 'Zarina Abdullah', rating: 4.6, rides: 987, earnings: 9875 },
    { name: 'Haziq Aiman', rating: 4.5, rides: 521, earnings: 5210 }
  ],
  
  peakHours: {
    labels: ['6AM', '8AM', '10AM', '12PM', '2PM', '4PM', '6PM', '8PM', '10PM'],
    values: [18, 42, 28, 32, 24, 36, 40, 34, 22],
    busiest: '8:00 AM - 9:00 AM',
    avgPerHour: 42
  },
  
  popularRoutes: [
    { from: 'UiTM Arau', to: 'Arau KTM Station', count: 245, avgFare: 12.30 },
    { from: 'Kolej Dahlia', to: 'Kompleks Star', count: 187, avgFare: 8.50 },
    { from: 'HEA UITM', to: 'ZUS Coffee', count: 156, avgFare: 6.80 },
    { from: 'Yasmeen Nasi Kandar', to: 'UiTM Arau', count: 132, avgFare: 12.30 },
    { from: 'Kolej Melati', to: 'McDonald\'s', count: 98, avgFare: 10.50 }
  ],
  
  detailedRides: [
    { date: '2024-01-15 09:45', user: 'Alif Mukhlis', driver: 'Yaseer Yahaya', 
      route: 'Yasmeen ‚Üí UiTM', distance: '7.5 km', fare: 'RM 12.30', rating: 5, status: 'completed' },
    { date: '2024-01-15 09:30', user: 'Nurul Huda', driver: 'Masturina Balqis', 
      route: 'Kolej Dahlia ‚Üí Kompleks', distance: '2.1 km', fare: 'RM 8.50', rating: 4, status: 'completed' },
    { date: '2024-01-15 09:15', user: 'Ahmad Firdaus', driver: 'Aiman Iskandar', 
      route: 'HEA ‚Üí KTM Station', distance: '4.3 km', fare: 'RM 15.20', rating: 5, status: 'completed' },
    { date: '2024-01-15 09:00', user: 'Siti Aminah', driver: 'Haziq Aiman', 
      route: 'UiTM ‚Üí ZUS Coffee', distance: '3.2 km', fare: 'RM 6.80', rating: 4, status: 'completed' },
    { date: '2024-01-15 08:45', user: 'Mohd Rizal', driver: 'Yaseer Yahaya', 
      route: 'Kolej Melati ‚Üí McDonald\'s', distance: '5.1 km', fare: 'RM 10.50', rating: 3, status: 'cancelled' },
    { date: '2024-01-15 08:30', user: 'Fatimah Zahra', driver: 'Zarina Abdullah', 
      route: 'HEA ‚Üí Yasmeen', distance: '6.2 km', fare: 'RM 14.80', rating: 5, status: 'completed' },
    { date: '2024-01-15 08:15', user: 'Hakim Ismail', driver: 'Aiman Iskandar', 
      route: 'UiTM ‚Üí Kompleks', distance: '2.8 km', fare: 'RM 7.90', rating: 4, status: 'completed' },
    { date: '2024-01-15 08:00', user: 'Noraisha Zain', driver: 'Masturina Balqis', 
      route: 'Kolej Anggerik ‚Üí ZUS', distance: '3.5 km', fare: 'RM 9.20', rating: 5, status: 'completed' }
  ]
};

// State Management
let currentReportType = '';
let currentExportFormat = '';

// Initialize Analytics
function initializeAnalytics() {
  renderRevenueChart();
  renderRideChart();
  renderUserChart();
  renderDriverLeaderboard();
  renderPeakHoursChart();
  renderPopularRoutes();
  renderDetailedTable();
  setupEventListeners();
}

// Set Date Range
function setDateRange(range) {
  const now = new Date();
  let startDate = new Date();
  let endDate = new Date();
  
  // Update active button
  document.querySelectorAll('.date-preset-btn').forEach(btn => {
    btn.classList.remove('active');
  });
  event.target.classList.add('active');
  
  switch(range) {
    case 'today':
      startDate.setHours(0, 0, 0, 0);
      endDate.setHours(23, 59, 59, 999);
      break;
      
    case 'yesterday':
      startDate.setDate(startDate.getDate() - 1);
      startDate.setHours(0, 0, 0, 0);
      endDate.setDate(endDate.getDate() - 1);
      endDate.setHours(23, 59, 59, 999);
      break;
      
    case 'week':
      startDate.setDate(startDate.getDate() - 7);
      break;
      
    case 'month':
      startDate.setMonth(startDate.getMonth() - 1);
      break;
      
    case 'quarter':
      startDate.setMonth(startDate.getMonth() - 3);
      break;
      
    case 'year':
      startDate.setFullYear(startDate.getFullYear() - 1);
      break;
  }
  
  // Format dates for input
  document.getElementById('startDate').value = formatDateForInput(startDate);
  document.getElementById('endDate').value = formatDateForInput(endDate);
  
  // In a real app, this would reload data
  showNotification(`Date range set to ${range}`, 'success');
}

// Format Date for Input
function formatDateForInput(date) {
  const year = date.getFullYear();
  const month = String(date.getMonth() + 1).padStart(2, '0');
  const day = String(date.getDate()).padStart(2, '0');
  return `${year}-${month}-${day}`;
}

// Render Revenue Chart
function renderRevenueChart() {
  const chart = document.getElementById('revenueChart');
  const data = reportsData.revenue;
  
  chart.innerHTML = '';
  
  const maxValue = Math.max(...data.values);
  
  data.values.forEach((value, index) => {
    const barHeight = (value / maxValue) * 180;
    const bar = document.createElement('div');
    bar.className = 'bar';
    bar.style.height = `${barHeight}px`;
    
    bar.innerHTML = `
      <div class="bar-label">${data.labels[index]}</div>
      <div class="bar-value">RM ${value.toLocaleString()}</div>
    `;
    
    chart.appendChild(bar);
  });
}

// Update Revenue Chart
function updateRevenueChart(granularity) {
  // In a real app, this would fetch new data
  showNotification(`Revenue chart updated to ${granularity} view`, 'success');
}

// Render Ride Chart
function renderRideChart() {
  const chart = document.getElementById('rideChart');
  const data = reportsData.rides;
  
  chart.innerHTML = '';
  
  data.values.forEach((value, index) => {
    const point = document.createElement('div');
    point.className = 'timeline-point';
    
    // Calculate position (simplified)
    const position = (value / Math.max(...data.values)) * 150;
    
    point.innerHTML = `
      <div class="point-value">${value}</div>
      <div class="point-dot" style="margin-bottom: ${position}px;"></div>
      ${index < data.values.length - 1 ? '<div class="point-line"></div>' : ''}
      <div class="point-label">${data.timeline[index]}</div>
    `;
    
    chart.appendChild(point);
  });
}

// Update Ride Metrics
function updateRideMetrics(view) {
  // In a real app, this would update the chart
  showNotification(`Ride metrics updated to ${view} view`, 'success');
}

// Render User Chart
function renderUserChart() {
  const chart = document.getElementById('userChart');
  const data = reportsData.users;
  
  chart.innerHTML = '';
  
  const maxValue = Math.max(...data.values);
  
  data.values.forEach((value, index) => {
    const barHeight = (value / maxValue) * 150;
    const bar = document.createElement('div');
    bar.className = 'bar';
    bar.style.height = `${barHeight}px`;
    
    bar.innerHTML = `
      <div class="bar-label">${data.labels[index]}</div>
      <div class="bar-value">${value.toLocaleString()}</div>
    `;
    
    chart.appendChild(bar);
  });
}

// Update User Chart
function updateUserChart(granularity) {
  // In a real app, this would fetch new data
  showNotification(`User chart updated to ${granularity} view`, 'success');
}

// Render Driver Leaderboard
function renderDriverLeaderboard() {
  const leaderboard = document.getElementById('driverLeaderboard');
  const drivers = reportsData.drivers;
  
  leaderboard.innerHTML = '';
  
  drivers.forEach((driver, index) => {
    const item = document.createElement('div');
    item.className = 'leaderboard-item fade-in';
    
    item.innerHTML = `
      <div class="leaderboard-rank">${index + 1}</div>
      <div class="leaderboard-info">
        <div class="leaderboard-name">${driver.name}</div>
        <div class="small muted">‚≠ê ${driver.rating} ‚Ä¢ ${driver.rides} rides</div>
      </div>
      <div class="leaderboard-value">RM ${driver.earnings.toLocaleString()}</div>
    `;
    
    leaderboard.appendChild(item);
  });
}

// Update Driver Leaderboard
function updateDriverLeaderboard(sortBy) {
  // Sort drivers based on criteria
  let sortedDrivers = [...reportsData.drivers];
  
  switch(sortBy) {
    case 'rating':
      sortedDrivers.sort((a, b) => b.rating - a.rating);
      break;
    case 'rides':
      sortedDrivers.sort((a, b) => b.rides - a.rides);
      break;
    case 'earnings':
      sortedDrivers.sort((a, b) => b.earnings - a.earnings);
      break;
  }
  
  const leaderboard = document.getElementById('driverLeaderboard');
  leaderboard.innerHTML = '';
  
  sortedDrivers.forEach((driver, index) => {
    const item = document.createElement('div');
    item.className = 'leaderboard-item fade-in';
    
    item.innerHTML = `
      <div class="leaderboard-rank">${index + 1}</div>
      <div class="leaderboard-info">
        <div class="leaderboard-name">${driver.name}</div>
        <div class="small muted">‚≠ê ${driver.rating} ‚Ä¢ ${driver.rides} rides</div>
      </div>
      <div class="leaderboard-value">RM ${driver.earnings.toLocaleString()}</div>
    `;
    
    leaderboard.appendChild(item);
  });
  
  showNotification(`Driver leaderboard sorted by ${sortBy}`, 'success');
}

// Render Peak Hours Chart
function renderPeakHoursChart() {
  const chart = document.getElementById('peakHoursChart');
  const data = reportsData.peakHours;
  
  chart.innerHTML = '';
  
  const maxValue = Math.max(...data.values);
  
  data.values.forEach((value, index) => {
    const barHeight = (value / maxValue) * 150;
    const bar = document.createElement('div');
    bar.className = 'bar';
    bar.style.height = `${barHeight}px`;
    
    bar.innerHTML = `
      <div class="bar-label">${data.labels[index]}</div>
      <div class="bar-value">${value}</div>
    `;
    
    chart.appendChild(bar);
  });
}

// Update Peak Hours
function updatePeakHours(filter) {
  // In a real app, this would fetch filtered data
  showNotification(`Peak hours updated for ${filter}`, 'success');
}

// Render Popular Routes
function renderPopularRoutes() {
  const routesList = document.getElementById('popularRoutes');
  const routes = reportsData.popularRoutes;
  
  routesList.innerHTML = '';
  
  routes.forEach((route, index) => {
    const item = document.createElement('div');
    item.className = 'leaderboard-item fade-in';
    
    item.innerHTML = `
      <div class="leaderboard-rank">${index + 1}</div>
      <div class="leaderboard-info">
        <div class="leaderboard-name">${route.from} ‚Üí ${route.to}</div>
        <div class="small muted">${route.count} rides ‚Ä¢ Avg RM${route.avgFare}</div>
      </div>
      <div class="leaderboard-value">${route.count}</div>
    `;
    
    routesList.appendChild(item);
  });
}

// Update Popular Routes
function updatePopularRoutes(timeframe) {
  // In a real app, this would fetch filtered data
  showNotification(`Popular routes updated for ${timeframe}`, 'success');
}

// Render Detailed Table
function renderDetailedTable() {
  const tbody = document.getElementById('detailedTableBody');
  const rides = reportsData.detailedRides;
  
  tbody.innerHTML = '';
  
  rides.forEach(ride => {
    const row = document.createElement('tr');
    
    const statusColor = ride.status === 'completed' ? '#4CAF50' : '#ff6b6b';
    
    row.innerHTML = `
      <td>${ride.date}</td>
      <td>${ride.user}</td>
      <td>${ride.driver}</td>
      <td>${ride.route}</td>
      <td>${ride.distance}</td>
      <td><strong>${ride.fare}</strong></td>
      <td>
        <div style="display: flex; align-items: center; gap: 4px;">
          <span style="color: #ffdd00;">${'‚òÖ'.repeat(ride.rating)}${'‚òÜ'.repeat(5 - ride.rating)}</span>
          <span>${ride.rating}.0</span>
        </div>
      </td>
      <td>
        <span style="color: ${statusColor}; font-weight: 600;">${ride.status}</span>
      </td>
    `;
    
    tbody.appendChild(row);
  });
}

// Update Detailed Table
function updateDetailedTable(view) {
  // In a real app, this would fetch filtered data
  showNotification(`Detailed table updated to ${view} view`, 'success');
}

// Generate Report
function generateReport() {
  const startDate = document.getElementById('startDate').value;
  const endDate = document.getElementById('endDate').value;
  
  // In a real app, this would generate a comprehensive report
  showNotification(`Report generated for ${startDate} to ${endDate}`, 'success');
  
  // Show loading and simulate report generation
  showExportModal('Generating comprehensive report...');
  
  setTimeout(() => {
    closeExportModal();
    showNotification('Report generated successfully! Check your downloads.', 'success');
  }, 2000);
}

// Open Report Modal
function openReportModal(reportType) {
  currentReportType = reportType;
  
  let title = '';
  let content = '';
  
  switch(reportType) {
    case 'financial':
      title = 'Financial Report Configuration';
      content = getFinancialReportConfig();
      break;
      
    case 'operational':
      title = 'Operational Report Configuration';
      content = getOperationalReportConfig();
      break;
      
    case 'user':
      title = 'User Analytics Report Configuration';
      content = getUserReportConfig();
      break;
      
    case 'driver':
      title = 'Driver Performance Report Configuration';
      content = getDriverReportConfig();
      break;
  }
  
  document.getElementById('reportModalTitle').textContent = title;
  document.getElementById('reportModalContent').innerHTML = content;
  document.getElementById('reportModal').style.display = 'flex';
}

// Get Financial Report Configuration
function getFinancialReportConfig() {
  return `
    <div class="form-group">
      <label class="form-label">Report Period</label>
      <select class="form-select" id="reportPeriod">
        <option value="daily">Daily</option>
        <option value="weekly" selected>Weekly</option>
        <option value="monthly">Monthly</option>
        <option value="quarterly">Quarterly</option>
        <option value="yearly">Yearly</option>
        <option value="custom">Custom Range</option>
      </select>
    </div>
    
    <div id="customRange" style="display: none;">
      <div class="form-row">
        <div class="form-group">
          <label class="form-label">Start Date</label>
          <input type="date" class="form-input" id="customStartDate">
        </div>
        <div class="form-group">
          <label class="form-label">End Date</label>
          <input type="date" class="form-input" id="customEndDate">
        </div>
      </div>
    </div>
    
    <div class="form-group">
      <label class="form-label">Include Sections</label>
      <div class="form-checkbox">
        <input type="checkbox" id="includeRevenue" checked>
        <label for="includeRevenue">Revenue Breakdown</label>
      </div>
      <div class="form-checkbox">
        <input type="checkbox" id="includeExpenses" checked>
        <label for="includeExpenses">Expenses Analysis</label>
      </div>
      <div class="form-checkbox">
        <input type="checkbox" id="includeProfit" checked>
        <label for="includeProfit">Profit Margins</label>
      </div>
      <div class="form-checkbox">
        <input type="checkbox" id="includeTrends" checked>
        <label for="includeTrends">Growth Trends</label>
      </div>
      <div class="form-checkbox">
        <input type="checkbox" id="includeForecast">
        <label for="includeForecast">Revenue Forecast</label>
      </div>
    </div>
    
    <div class="form-group">
      <label class="form-label">Granularity</label>
      <select class="form-select" id="granularity">
        <option value="summary">Summary Only</option>
        <option value="detailed" selected>Detailed Breakdown</option>
        <option value="transaction">Transaction Level</option>
      </select>
    </div>
    
    <div class="modal-actions">
      <button class="small-btn" onclick="closeReportModal()">Cancel</button>
      <button class="btn" onclick="configureAndGenerateReport()">Generate Report</button>
    </div>
    
    <script>
      document.getElementById('reportPeriod').addEventListener('change', function() {
        document.getElementById('customRange').style.display = 
          this.value === 'custom' ? 'block' : 'none';
      });
    </script>
  `;
}

// Get Operational Report Configuration
function getOperationalReportConfig() {
  return `
    <div class="form-group">
      <label class="form-label">Report Type</label>
      <select class="form-select" id="operationalType">
        <option value="performance">Performance Overview</option>
        <option value="efficiency">Operational Efficiency</option>
        <option value="quality">Service Quality</option>
        <option value="comprehensive">Comprehensive Analysis</option>
      </select>
    </div>
    
    <div class="form-group">
      <label class="form-label">Metrics to Include</label>
      <div class="form-checkbox">
        <input type="checkbox" id="includeRideStats" checked>
        <label for="includeRideStats">Ride Statistics</label>
      </div>
      <div class="form-checkbox">
        <input type="checkbox" id="includeDriverPerf" checked>
        <label for="includeDriverPerf">Driver Performance</label>
      </div>
      <div class="form-checkbox">
        <input type="checkbox" id="includeVehicleStats">
        <label for="includeVehicleStats">Vehicle Utilization</label>
      </div>
      <div class="form-checkbox">
        <input type="checkbox" id="includePeakHours" checked>
        <label for="includePeakHours">Peak Hours Analysis</label>
      </div>
      <div class="form-checkbox">
        <input type="checkbox" id="includePopularRoutes" checked>
        <label for="includePopularRoutes">Popular Routes</label>
      </div>
    </div>
    
    <div class="form-row">
      <div class="form-group">
        <label class="form-label">Date Range</label>
        <input type="date" class="form-input" id="opStartDate" value="2024-01-01">
      </div>
      <div class="form-group">
        <label class="form-label">&nbsp;</label>
        <input type="date" class="form-input" id="opEndDate" value="2024-12-31">
      </div>
    </div>
    
    <div class="form-group">
      <label class="form-label">Comparison Period</label>
      <select class="form-select" id="comparisonPeriod">
        <option value="none">No Comparison</option>
        <option value="previous">Previous Period</option>
        <option value="yoy">Year-over-Year</option>
        <option value="target">Against Targets</option>
      </select>
    </div>
    
    <div class="modal-actions">
      <button class="small-btn" onclick="closeReportModal()">Cancel</button>
      <button class="btn" onclick="configureAndGenerateReport()">Generate Report</button>
    </div>
  `;
}

// Get User Report Configuration
function getUserReportConfig() {
  return `
    <div class="form-group">
      <label class="form-label">Report Focus</label>
      <select class="form-select" id="userFocus">
        <option value="growth">User Growth</option>
        <option value="retention">Retention Analysis</option>
        <option value="behavior">Behavioral Patterns</option>
        <option value="demographics">Demographics</option>
        <option value="comprehensive">Comprehensive Analysis</option>
      </select>
    </div>
    
    <div class="form-group">
      <label class="form-label">User Segments</label>
      <div class="form-checkbox">
        <input type="checkbox" id="segmentNew" checked>
        <label for="segmentNew">New Users</label>
      </div>
      <div class="form-checkbox">
        <input type="checkbox" id="segmentActive" checked>
        <label for="segmentActive">Active Users</label>
      </div>
      <div class="form-checkbox">
        <input type="checkbox" id="segmentInactive">
        <label for="segmentInactive">Inactive Users</label>
      </div>
      <div class="form-checkbox">
        <input type="checkbox" id="segmentChurned">
        <label for="segmentChurned">Churned Users</label>
      </div>
    </div>
    
    <div class="form-group">
      <label class="form-label">Time Period</label>
      <select class="form-select" id="userTimePeriod">
        <option value="7days">Last 7 Days</option>
        <option value="30days" selected>Last 30 Days</option>
        <option value="90days">Last 90 Days</option>
        <option value="year">Last Year</option>
        <option value="alltime">All Time</option>
      </select>
    </div>
    
    <div class="form-group">
      <label class="form-label">Metrics</label>
      <div class="form-checkbox">
        <input type="checkbox" id="metricAcquisition" checked>
        <label for="metricAcquisition">Acquisition Metrics</label>
      </div>
      <div class="form-checkbox">
        <input type="checkbox" id="metricRetention" checked>
        <label for="metricRetention">Retention Metrics</label>
      </div>
      <div class="form-checkbox">
        <input type="checkbox" id="metricEngagement" checked>
        <label for="metricEngagement">Engagement Metrics</label>
      </div>
      <div class="form-checkbox">
        <input type="checkbox" id="metricRevenue">
        <label for="metricRevenue">Revenue per User</label>
      </div>
    </div>
    
    <div class="modal-actions">
      <button class="small-btn" onclick="closeReportModal()">Cancel</button>
      <button class="btn" onclick="configureAndGenerateReport()">Generate Report</button>
    </div>
  `;
}

// Get Driver Report Configuration
function getDriverReportConfig() {
  return `
    <div class="form-group">
      <label class="form-label">Report Type</label>
      <select class="form-select" id="driverReportType">
        <option value="performance">Performance Overview</option>
        <option value="earnings">Earnings Analysis</option>
        <option value="compliance">Compliance Status</option>
        <option value="ranking">Driver Rankings</option>
        <option value="comprehensive">Comprehensive Report</option>
      </select>
    </div>
    
    <div class="form-group">
      <label class="form-label">Driver Filter</label>
      <select class="form-select" id="driverFilter">
        <option value="all">All Drivers</option>
        <option value="active">Active Drivers Only</option>
        <option value="top">Top 20 Performers</option>
        <option value="new">New Drivers (Last 30 days)</option>
        <option value="inactive">Inactive Drivers</option>
      </select>
    </div>
    
    <div class="form-group">
      <label class="form-label">Performance Metrics</label>
      <div class="form-checkbox">
        <input type="checkbox" id="perfRating" checked>
        <label for="perfRating">Ratings & Reviews</label>
      </div>
      <div class="form-checkbox">
        <input type="checkbox" id="perfRides" checked>
        <label for="perfRides">Ride Statistics</label>
      </div>
      <div class="form-checkbox">
        <input type="checkbox" id="perfEarnings" checked>
        <label for="perfEarnings">Earnings Analysis</label>
      </div>
      <div class="form-checkbox">
        <input type="checkbox" id="perfAcceptance">
        <label for="perfAcceptance">Acceptance Rates</label>
      </div>
      <div class="form-checkbox">
        <input type="checkbox" id="perfCancellation">
        <label for="perfCancellation">Cancellation Rates</label>
      </div>
    </div>
    
    <div class="form-row">
      <div class="form-group">
        <label class="form-label">Date Range</label>
        <input type="date" class="form-input" id="driverStartDate" value="2024-01-01">
      </div>
      <div class="form-group">
        <label class="form-label">&nbsp;</label>
        <input type="date" class="form-input" id="driverEndDate" value="2024-12-31">
      </div>
    </div>
    
    <div class="modal-actions">
      <button class="small-btn" onclick="closeReportModal()">Cancel</button>
      <button class="btn" onclick="configureAndGenerateReport()">Generate Report</button>
    </div>
  `;
}

// Configure and Generate Report
function configureAndGenerateReport() {
  // Collect configuration from form
  const config = {
    type: currentReportType,
    timestamp: new Date().toISOString()
  };
  
  // Show export modal
  showExportModal(`Generating ${currentReportType} report...`);
  
  // Simulate report generation
  setTimeout(() => {
    closeExportModal();
    closeReportModal();
    showNotification(`${currentReportType.replace(/^\w/, c => c.toUpperCase())} report generated successfully!`, 'success');
  }, 1500);
}

// Export Report
function exportReport(reportType, format) {
  currentReportType = reportType;
  currentExportFormat = format;
  
  showExportModal(`Exporting ${reportType} report as ${format.toUpperCase()}...`);
  
  // Simulate export process
  setTimeout(() => {
    closeExportModal();
    
    // Create download link
    const content = `Sample ${reportType} report data in ${format} format`;
    const blob = new Blob([content], { type: getMimeType(format) });
    const url = window.URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `${reportType}_report_${new Date().toISOString().split('T')[0]}.${format}`;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    window.URL.revokeObjectURL(url);
    
    showNotification(`Report exported as ${format.toUpperCase()} successfully!`, 'success');
  }, 2000);
}

// Get MIME Type for Export
function getMimeType(format) {
  switch(format) {
    case 'pdf': return 'application/pdf';
    case 'excel': return 'application/vnd.ms-excel';
    case 'csv': return 'text/csv';
    default: return 'text/plain';
  }
}

// Show Export Modal
function showExportModal(message) {
  document.getElementById('exportMessage').textContent = message;
  document.getElementById('exportModal').style.display = 'flex';
}

// Close Export Modal
function closeExportModal() {
  document.getElementById('exportModal').style.display = 'none';
}

// Close Report Modal
function closeReportModal() {
  document.getElementById('reportModal').style.display = 'none';
  currentReportType = '';
}

// Show Notification
function showNotification(message, type) {
  const notification = document.createElement('div');
  notification.className = `notification ${type}`;
  notification.innerHTML = `
    <div style="display: flex; align-items: center; gap: 12px;">
      <div style="font-size: 20px;">
        ${type === 'success' ? '‚úì' : type === 'error' ? '‚úó' : '‚ö†Ô∏è'}
      </div>
      <div>${message}</div>
    </div>
  `;
  
  notification.style.cssText = `
    position: fixed;
    top: 20px;
    right: 20px;
    background: ${type === 'success' ? 'rgba(76, 175, 80, 0.15)' : 
                 type === 'error' ? 'rgba(255, 107, 107, 0.15)' : 
                 'rgba(255, 221, 0, 0.15)'};
    border: 1px solid ${type === 'success' ? 'rgba(76, 175, 80, 0.3)' : 
                       type === 'error' ? 'rgba(255, 107, 107, 0.3)' : 
                       'rgba(255, 221, 0, 0.3)'};
    color: ${type === 'success' ? '#4CAF50' : 
            type === 'error' ? '#ff6b6b' : '#ffdd00'};
    padding: 16px 24px;
    border-radius: 12px;
    backdrop-filter: blur(10px);
    z-index: 10000;
    animation: slideIn 0.3s ease-out;
  `;
  
  document.body.appendChild(notification);
  
  setTimeout(() => {
    notification.style.animation = 'slideOut 0.3s ease-out';
    setTimeout(() => {
      document.body.removeChild(notification);
    }, 300);
  }, 3000);
}

// Setup Event Listeners
function setupEventListeners() {
  // Close modals when clicking outside
  document.addEventListener('click', (e) => {
    if (e.target.classList.contains('modal-overlay')) {
      closeReportModal();
      closeExportModal();
    }
  });
  
  // Close modals with Escape key
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
      closeReportModal();
      closeExportModal();
    }
  });
}

// Initialize on load
document.addEventListener('DOMContentLoaded', initializeAnalytics);

// Add CSS animations
const style = document.createElement('style');
style.textContent = `
  @keyframes slideIn {
    from {
      transform: translateX(100%);
      opacity: 0;
    }
    to {
      transform: translateX(0);
      opacity: 1;
    }
  }
  
  @keyframes slideOut {
    from {
      transform: translateX(0);
      opacity: 1;
    }
    to {
      transform: translateX(100%);
      opacity: 0;
    }
  }
  
  .fade-in {
    animation: fadeIn 0.3s ease-out;
  }
  
  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  
  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }
`;
document.head.appendChild(style);
</script>
</body>
</html>